// -------------------------------------
// WARNING
// THIS FILE IS AUTOGENERATED BY PRISMERGE
// DO NOT MANUALLY EDIT THIS FILE!
// -------------------------------------

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

generator typegraphqlTranspiled {
  provider           = "typegraphql-prisma"
  output             = "./src/graphql/__generated__/type-graphql-transpiled"
  emitTranspiledCode = true
  // useUncheckedScalarInputs = true
}

generator typegraphql {
  provider = "typegraphql-prisma"
  output   = "./src/graphql/__generated__/type-graphql"
  // useUncheckedScalarInputs = true
}

model Attribute {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt

  /// @TypeGraphQL.omit(input: true)
  teamId String
  /// @TypeGraphQL.omit(input: true)
  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)


  name       String
  namePlural String

  inventory        AttributeInventory[]
  inventoryHistory AttributeInventoryHistory[]
  projectParts     AttributesOnProject[]
  subthemes        AttributesOnSubtheme[]
}

model Member {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt

  /// @TypeGraphQL.omit(input: true)
  teamId String
  /// @TypeGraphQL.omit(input: true)
  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)


  role Role

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, teamId])
}

model Project {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  name        String
  slug        String @unique
  description Json?
  number      Int

  status  ProjectStatus
  parts   ProjectPart[]
  stats   StatsOnProject[]
  history ProjectHistory[]

  subthemeId   String
  subtheme     Subtheme @relation(fields: [subthemeId], references: [id], onDelete: Cascade)
  supervisorId String?
  supervisor   User?    @relation(name: "supervisor", fields: [supervisorId], references: [id], onDelete: SetNull)
  createdById  String?
  createdBy    User?    @relation(name: "createdProject", fields: [createdById], references: [id], onDelete: SetNull)
}

model Session {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  expiresAt DateTime?
  // @TypeGraphQL.omit(output: true)
  token     String    @unique

  userId String
  user   User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  /// @TypeGraphQL.omit(input: true)
  teamId String?
  /// @TypeGraphQL.omit(input: true)
  team   Team?   @relation(fields: [teamId], references: [id], onDelete: SetNull)
}

model Team {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  name String

  members    Member[]
  sessions   Session[]
  events     Event[]
  stoneTypes StoneType[]
  attributes Attribute[]
  stats      Stat[]
}

model User {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  firstName   String
  lastName    String
  displayName String
  slug        String @unique

  // TODO
  /// @TypeGraphQL.omit(output: true)
  password String?
  avatar   String?
  email    String  @unique
  isAdmin  Boolean @default(false)

  sessions                  Session[]
  stoneInventory            StoneInventory[]
  stonesOnProjectParts      StonesOnProject[]
  stonesOnSubthemes         StonesOnSubtheme[]
  stoneInventoryHistory     StoneInventoryHistory[]
  attributeInventory        AttributeInventory[]
  attributesOnProjectParts  AttributesOnProject[]
  attributesOnSubthemes     AttributesOnSubtheme[]
  attributeInventoryHistory AttributeInventoryHistory[]
  projectHistory            ProjectHistory[]
  supervisingProjects       Project[]                   @relation("supervisor")
  createdProjects           Project[]                   @relation("createdProject")

  /// The teams this user is a member of
  teams Member[]
}

// Authentication

// Teams

enum Role {
  CAPTAIN
  BUILDER
  GUEST
}

// Events

model Event {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt

  /// @TypeGraphQL.omit(input: true)
  teamId String
  /// @TypeGraphQL.omit(input: true)
  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)


  name String
  date DateTime
  slug String   @unique
  img  String

  subthemes Subtheme[]
}

model Subtheme {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  name  String
  color String
  order Int
  slug  String @unique

  projects   Project[]
  attributes AttributesOnSubtheme[]
  stones     StonesOnSubtheme[]

  eventId String
  event   Event  @relation(fields: [eventId], references: [id], onDelete: Cascade)
}

enum ProjectStatus {
  CANCELLED
  PLANNED
  DESIGNING
  DESIGNED
  READY
  BUILDING
  BUILT
  COUNTED
}

enum ProjectType {
  FIELD_L1
  FIELD_L2
  FIELD_M50
  FIELD_FLAT
  FIELD_CROSS_L1
  FIELD_CROSS_L2
  FIELD_CROSS_M50
  FIELD_CIRCLE
  WALL_X
  WALL_S
  WALL_T
  WALL_SPEED
  WALL_CUBE
  WALL_OCTO
  FALLWALL
  SPIRAL
  STRUCTURE
  FREE_HAND
  DECOR
  OTHER
}

model ProjectPart {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  name        String
  slug        String  @unique
  description String?
  number      Int

  type       ProjectType
  stones     StonesOnProject[]
  attributes AttributesOnProject[]

  projectId String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
}

model ProjectHistory {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  fieldName String
  oldValue  String?
  newValue  String

  projectId String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  userId    String
  user      User    @relation(fields: [userId], references: [id], onDelete: Restrict)
}

model Stat {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt

  /// @TypeGraphQL.omit(input: true)
  teamId String
  /// @TypeGraphQL.omit(input: true)
  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)


  name String

  projects StatsOnProject[]
}

model StatsOnProject {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  value String

  statId    String
  stat      Stat    @relation(fields: [statId], references: [id], onDelete: Restrict)
  projectId String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
}

// Inventory

model StoneType {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt

  /// @TypeGraphQL.omit(input: true)
  teamId String
  /// @TypeGraphQL.omit(input: true)
  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)


  name        String
  description String?
  order       Int

  stones Stone[]
}

model Stone {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  name        String
  alias       String
  alias2      String?
  hex         String
  hex2        String?
  description String?
  order       Int

  inventory    StoneInventory[]
  projectParts StonesOnProject[]
  subthemes    StonesOnSubtheme[]
  history      StoneInventoryHistory[]

  stoneTypeId String
  stoneType   StoneType @relation(fields: [stoneTypeId], references: [id], onDelete: Cascade)
}

model StoneInventory {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  amount Int

  stoneId String
  stone   Stone  @relation(fields: [stoneId], references: [id], onDelete: Cascade)
  userId  String
  user    User   @relation(fields: [userId], references: [id], onDelete: Cascade)
}

// TODO rename back
model StonesOnProject {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  amount Int

  stoneId       String
  stone         Stone       @relation(fields: [stoneId], references: [id], onDelete: Restrict)
  userId        String
  user          User        @relation(fields: [userId], references: [id], onDelete: Restrict)
  projectPartId String
  projectPart   ProjectPart @relation(fields: [projectPartId], references: [id], onDelete: Cascade)
}

model StonesOnSubtheme {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  amount Int

  stoneId    String
  stone      Stone    @relation(fields: [stoneId], references: [id], onDelete: Restrict)
  userId     String
  user       User     @relation(fields: [userId], references: [id], onDelete: Restrict)
  subthemeId String
  subtheme   Subtheme @relation(fields: [subthemeId], references: [id], onDelete: Cascade)
}

model StoneInventoryHistory {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  fieldName String
  oldValue  String
  newValue  String

  stoneId String
  stone   Stone  @relation(fields: [stoneId], references: [id], onDelete: Cascade)
  userId  String
  user    User   @relation(fields: [userId], references: [id], onDelete: Restrict)
}

model AttributeInventory {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  amount Int

  attributeId String
  attribute   Attribute @relation(fields: [attributeId], references: [id], onDelete: Cascade)
  userId      String
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)
}

// TODO rename back
model AttributesOnProject {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  amount Int

  attributeId   String
  attribute     Attribute   @relation(fields: [attributeId], references: [id], onDelete: Restrict)
  userId        String
  user          User        @relation(fields: [userId], references: [id], onDelete: Restrict)
  projectPartId String
  projectPart   ProjectPart @relation(fields: [projectPartId], references: [id], onDelete: Cascade)
}

model AttributesOnSubtheme {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  amount Int

  attributeId String
  attribute   Attribute @relation(fields: [attributeId], references: [id], onDelete: Restrict)
  userId      String
  user        User      @relation(fields: [userId], references: [id], onDelete: Restrict)
  subthemeId  String
  subtheme    Subtheme  @relation(fields: [subthemeId], references: [id], onDelete: Cascade)
}

model AttributeInventoryHistory {
  // Meta information
  /// @TypeGraphQL.omit(input: ["create", "update"])
  id        String   @id @default(uuid())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  createdAt DateTime @default(now())
  /// @TypeGraphQL.omit(input: ["create", "update"])
  updatedAt DateTime @updatedAt


  fieldName String
  oldValue  String
  newValue  String

  attributeId String
  attribute   Attribute @relation(fields: [attributeId], references: [id], onDelete: Cascade)
  userId      String
  user        User      @relation(fields: [userId], references: [id], onDelete: Restrict)
}
